<div class="w-full max-w-3xl">

    <!-- Form -->
    <form [formGroup]="planBillingForm">
        <div class="grid sm:grid-cols-3 gap-4 w-full mt-6">
            <mat-radio-group
                class="invisible absolute w-0 h-0 pointer-events-none"
                [formControlName]="'plan'"
                [disabled]="true"
                #planRadioGroup="matRadioGroup">
                <ng-container *ngFor="let plan of plans; trackBy: trackByFn">
                    <mat-radio-button [value]="plan.value" [disabled]="true"></mat-radio-button>
                </ng-container>
            </mat-radio-group>
            <ng-container *ngFor="let plan of plans; trackBy: trackByFn">
                <div
                    class="relative flex flex-col items-start justify-start p-6 rounded-md shadow bg-card"
                    [ngClass]="{
                        'ring ring-inset ring-primary bg-white': planRadioGroup.value === plan.value,
                        'opacity-60': planRadioGroup.value !== plan.value
                    }">
                    <ng-container *ngIf="planRadioGroup.value === plan.value">
                        <mat-icon
                            class="absolute top-0 right-0 mt-3 mr-3 icon-size-7 text-primary"
                            [svgIcon]="'heroicons_solid:check-circle'"></mat-icon>
                    </ng-container>
                    
                    <!-- Plan Header -->
                    <div class="w-full">
                        <div class="font-semibold text-lg" 
                             [ngClass]="{'text-primary dark:text-gray-900': planRadioGroup.value === plan.value, 'text-gray-900 dark:text-white': planRadioGroup.value !== plan.value}">
                            {{plan.label}}
                        </div>
                        <div class="mt-1 text-sm font-medium"
                             [ngClass]="{'text-primary dark:text-gray-700': planRadioGroup.value === plan.value, 'text-secondary': planRadioGroup.value !== plan.value}">
                            {{plan.details}}
                        </div>
                    </div>

                    <!-- Plan Description -->
                    <div class="mt-4 text-sm leading-relaxed"
                         [ngClass]="{'text-gray-700 dark:text-gray-800': planRadioGroup.value === plan.value, 'text-gray-600 dark:text-gray-400': planRadioGroup.value !== plan.value}">
                        {{plan.description}}
                    </div>

                    <!-- Features List -->
                    <div class="mt-6 w-full">
                        <div class="text-sm font-medium mb-3"
                             [ngClass]="{'text-gray-800 dark:text-gray-900': planRadioGroup.value === plan.value, 'text-gray-700 dark:text-gray-300': planRadioGroup.value !== plan.value}">
                            {{ 'plans.key_features' | transloco }}
                        </div>
                        <ul class="space-y-2">
                            <li *ngFor="let feature of plan.features" class="flex items-start text-sm"
                                [ngClass]="{'text-gray-700 dark:text-gray-800': planRadioGroup.value === plan.value, 'text-gray-600 dark:text-gray-400': planRadioGroup.value !== plan.value}">
                                <mat-icon class="icon-size-4 mr-2 mt-0.5" 
                                         [ngClass]="{'text-primary dark:text-gray-700': planRadioGroup.value === plan.value, 'text-gray-400 dark:text-gray-500': planRadioGroup.value !== plan.value}"
                                         [svgIcon]="'heroicons_solid:check'"></mat-icon>
                                <span>{{feature}}</span>
                            </li>
                        </ul>
                    </div>

                    <!-- Price -->
                    <div class="flex-auto"></div>
                    <div class="mt-6 w-full text-center">
                        <div class="text-3xl font-bold"
                             [ngClass]="{'text-primary dark:text-gray-900': planRadioGroup.value === plan.value, 'text-gray-400 dark:text-gray-500': planRadioGroup.value !== plan.value}">
                            <span>{{plan.price | currency:'MAD':'':'1.0'}} MAD</span>
                        </div>
                        <div class="text-sm"
                             [ngClass]="{'text-gray-600 dark:text-gray-700': planRadioGroup.value === plan.value, 'text-secondary': planRadioGroup.value !== plan.value}">
                            {{ 'plans.per_month' | transloco }}
                        </div>
                    </div>
                </div>
            </ng-container>
        </div>

    </form>

</div>
